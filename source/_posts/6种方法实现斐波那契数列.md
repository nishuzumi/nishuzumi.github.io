---
title: 6ç§æ–¹æ³•å®ç°æ–æ³¢é‚£å¥‘æ•°åˆ—
date: 2020-11-20 16:29:56
tags:
catagories:
- [JS]
- [å‰ç«¯]
- [All In Code]
---
## å‰è¨€ ğŸ¤
é—²æ¥æ— äº‹æƒ³åˆ°æŠ˜è…¾ç‚¹æ²¡ç”¨çš„ã€‚
<!--more-->

## æ™®é€šé€’å½’æ³•
```js
function (n) { // N,N
    if (n < 2) return n
    return arguments.callee(n - 1) + arguments.callee(n - 2)
}
```
## å°¾é€’å½’ä¼˜åŒ–æ³•
```js
function fibonacci(n, current, next) {
    if(n === 1) return next;
    if(n === 0) return 0;
    return fibonacci(n - 1, next, current + next);
}
```
## åŠ¨æ€è§„åˆ’æ³•
```js
(n) => { // åŠ¨æ€è§„åˆ’ N,1
    let dp = [0, 1]
    for (let i = 2; i <= n; i++) {
        dp[i] = dp[i - 1] + dp[i - 2]
    }
    return dp[n]
}
```

## åŠ¨æ€è§„åˆ’ï¼Œè¡¨é¢ç©ºé—´å¤æ‚åº¦O(1)æ³•
```js
(n) => { // åŠ¨æ€è§„åˆ’ç¼©å‡ç‰ˆ è¡¨é¢ N,1
    let [prev, cur] = [0, 1]
    while (n-- > 0) [prev, cur] = [cur, prev + cur]
    return prev
}
```

## åŠ¨æ€è§„åˆ’ï¼ŒçœŸå®ç©ºé—´å¤æ‚åº¦O(1)æ³•
```js
(n) => { // çœŸå®åŠ¨æ€è§„åˆ’ç¼©å‡ç‰ˆ N,1 
    let prev = 0,cur = 1
    let t = 0
    while (n-- > 0){
        t = prev
        prev = cur
        cur = t + cur
    }
    return prev
}
```
## Array.reduceå®ç°
```js
(n) => { // N,1
    return new Array(n).fill(0).reduce(prev => [prev[1], prev[0] + prev[1]], [0, 1])[0]
}
```
## ç”Ÿæˆå™¨æ³•
```js
(n)=>{ // ä¸€ä¸ªæ²¡å•¥æ„ä¹‰çš„ç‰ˆæœ¬ N,1
    let g = (function* (){
        let [cur,last] = [0,1]
        yield cur;
        yield last;
        while(true){
            yield (cur + last);
            [cur,last] = [last,cur + last]
        }
    })()

    let result = 0
    while(n-->= 0) result = g.next().value
    return result
}
```
## æ—¶ç©ºæ¯”è¾ƒ
|ç±»å‹|æ—¶é—´|ç©ºé—´|
|----|---|---|
|reduce|0.250ms|9.734KB|
|nomarl|0.072ms|1.757KB|
|nomarl-one-space|0.096ms|14.367KB|
|nomarl-one-space-real|0.049m|0.484KB|
|recursion|75267.654ms|14584.625KB|
|recursion-plus|0.140ms|14.265KB|
|generator|0.200ms|21.0546KB|

## æ€»ç»“ ğŸ‘¨â€ğŸ«
Generatorä¸åº”è¯¥åœ¨è¿™ç§åœºæ™¯ä½¿ç”¨ï¼Œæœ‰ç‚¹å¯¹ä¸ä½ä»–ã€‚

## é™„å¸¦æµ‹è¯•ç‰ˆæœ¬
```js
"use strict";
let tree = {
    'reduce': (n) => { // N,1
        return new Array(n).fill(0).reduce(prev => [prev[1], prev[0] + prev[1]], [0, 1])[0]
    },
    'nomarl': (n) => { // åŠ¨æ€è§„åˆ’ N,1
        let dp = [0, 1]
        for (let i = 2; i <= n; i++) {
            dp[i] = dp[i - 1] + dp[i - 2]
        }
        return dp[n]
    },
    'nomarl-one-space': (n) => { // åŠ¨æ€è§„åˆ’ç¼©å‡ç‰ˆ è¡¨é¢ N,1
        let [prev, cur] = [0, 1]
        while (n-- > 0) [prev, cur] = [cur, prev + cur]
        return prev
    },
    'nomarl-one-space-real': (n) => { // çœŸå®åŠ¨æ€è§„åˆ’ç¼©å‡ç‰ˆ N,1 
        let prev = 0,cur = 1
        let t = 0
        while (n-- > 0){
            t = prev
            prev = cur
            cur = t + cur
        }
        return prev
    },
    'recursion': function (n) { // N,N
        if (n < 2) return n
        return arguments.callee(n - 1) + arguments.callee(n - 2) // arrow have not arguments
    },
    'generator':(n)=>{ // ä¸€ä¸ªæ²¡å•¥æ„ä¹‰çš„ç‰ˆæœ¬ N,1
        let g = (function* (){
            let [cur,last] = [0,1]
            yield cur;
            yield last;
            while(true){
                yield (cur + last);
                [cur,last] = [last,cur + last]
            }
        })()

        let result = 0
        while(n-->= 0) result = g.next().value
        return result
    },
    'recursion-plus':function fibonacci(n, current, next) {
        if(n === 1) return next;
        if(n === 0) return 0;
        return fibonacci(n - 1, next, current + next);
    }
    
}

Object.keys(tree).forEach(name => {
    console.time(name)
    let mem = process.memoryUsage()
    let fib = tree[name]
    function no(n) {
        throw new Error(`${n} but ${fib(n)}`)
    }
    try {
        fib(0) == 0 || no(0)
        fib(1) == 1 || no(1)
        fib(2) == 1 || no(2)
        fib(10) == 55 || no(10)
        fib(45) == 1134903170 || no(45)
    } catch (e) {
        console.log(`err:${name} when ${e.message}`)
    }
    let nowMem = process.memoryUsage()
    console.timeEnd(name)
    
    console.log(`${name} mem:${(nowMem.heapUsed - mem.heapUsed)/1024}KB`)
});
```